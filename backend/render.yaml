services:
  - type: web
    name: asteria-backend
    env: docker
    dockerfilePath: ./Dockerfile
    dockerContext: .
    plan: free
    region: oregon  # or change to your closest region
    branch: main
    rootDir: backend
    envVars:
      - key: GIN_MODE
        value: release
      - key: PORT
        value: 10000
      - key: SUPABASE_URL
        sync: false  # Add in Render dashboard (sensitive)
      - key: SUPABASE_ANON_KEY
        sync: false
      - key: SUPABASE_SERVICE_ROLE_KEY
        sync: false
      - key: JWT_SECRET
        generateValue: true  # Render auto-generates
      - key: SMTP_HOST
        value: smtp.gmail.com
      - key: SMTP_PORT
        value: 587
      - key: SMTP_USERNAME
        sync: false
      - key: SMTP_PASSWORD
        sync: false
      - key: SMTP_FROM_NAME
        value: Asteria
      - key: SMTP_FROM_EMAIL
        value: noreply@asteria.app
      - key: CORS_ALLOWED_ORIGINS
        value: https://asteria.app
      - key: FRONTEND_URL
        value: https://asteria.app
    healthCheckPath: /health
    autoDeploy: true